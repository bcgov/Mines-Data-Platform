{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "factoryName": {
            "type": "string",
            "metadata": "Data Factory name",
            "defaultValue": "adf-postgres-peered"
        },
        "AzurePostgreSql1_connectionString": {
            "type": "secureString",
            "metadata": "Secure string for 'connectionString' of 'AzurePostgreSql1'"
        },
        "AzureBlobStorage1_connectionString": {
            "type": "secureString",
            "metadata": "Secure string for 'connectionString' of 'AzureBlobStorage1'"
        },
        "AzureDataLakeStorage1_accountKey": {
            "type": "secureString",
            "metadata": "Secure string for 'accountKey' of 'AzureDataLakeStorage1'"
        },
        "AzureSqlDatabase1_password": {
            "type": "secureString",
            "metadata": "Secure string for 'password' of 'AzureSqlDatabase1'"
        },
        "AzureDataLakeStorage1_properties_typeProperties_url": {
            "type": "string",
            "defaultValue": "https://datarepositorysa.dfs.core.windows.net/"
        },
        "AzureSqlDatabase1_properties_typeProperties_server": {
            "type": "string",
            "defaultValue": "mdp-sql-server.database.windows.net"
        },
        "AzureSqlDatabase1_properties_typeProperties_database": {
            "type": "string",
            "defaultValue": "MDP-DWH"
        },
        "AzureSqlDatabase1_properties_typeProperties_userName": {
            "type": "string",
            "defaultValue": "vrutstein"
        }
    },
    "variables": {
        "factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
    },
    "resources": [
        {
            "name": "[concat(parameters('factoryName'), '/MDP-DWH Refresh')]",
            "type": "Microsoft.DataFactory/factories/triggers",
            "apiVersion": "2018-06-01",
            "properties": {
                "annotations": [],
                "runtimeState": "Stopped",
                "pipelines": [
                    {
                        "pipelineReference": {
                            "referenceName": "MDP-DWH_Refresh",
                            "type": "PipelineReference"
                        },
                        "parameters": {}
                    }
                ],
                "type": "ScheduleTrigger",
                "typeProperties": {
                    "recurrence": {
                        "frequency": "Week",
                        "interval": 1,
                        "startTime": "2024-12-09T21:33:00",
                        "timeZone": "Pacific Standard Time",
                        "schedule": {
                            "minutes": [
                                0
                            ],
                            "hours": [
                                12
                            ],
                            "weekDays": [
                                "Monday",
                                "Tuesday",
                                "Wednesday",
                                "Thursday",
                                "Friday"
                            ]
                        }
                    }
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/pipelines/MDP-DWH_Refresh')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/DelimitedText1')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "AzureBlobStorage1",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": "tablelist.csv",
                        "folderPath": "control",
                        "container": "postgres"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": []
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/AzurePostgreSqlTable1')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "AzurePostgreSql1",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzurePostgreSqlTable",
                "schema": [
                    {
                        "name": "id",
                        "type": "integer",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "messageid",
                        "type": "integer",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "type",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "org_legalname",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "org_doingbusinessas",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "ind_firstname",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "ind_lastname",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "ind_middlename",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "ind_phonenumber",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "dayphonenumber",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "dayphonenumberext",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "faxnumber",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "email",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "org_bcfedincorpnumber",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "org_bcregnumber",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "org_societynumber",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "org_hstregnumber",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "org_contactname",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "mailingaddressline1",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "contacttype",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "contactcertificationtype",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "contactcertificationid",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "mailingaddressline2",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "mailingaddresscity",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "mailingaddressprovstate",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "mailingaddresscountry",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "mailingaddresspostalzip",
                        "type": "character varying",
                        "precision": 0,
                        "scale": 0
                    },
                    {
                        "name": "seq_no",
                        "type": "integer",
                        "precision": 0,
                        "scale": 0
                    }
                ],
                "typeProperties": {
                    "schema": "now_submissions",
                    "table": "contact"
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/AzurePostgreSql1')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/Parquet1')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "AzureBlobStorage1",
                    "type": "LinkedServiceReference"
                },
                "parameters": {
                    "table_name": {
                        "type": "string"
                    }
                },
                "annotations": [],
                "type": "Parquet",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": {
                            "value": "@dataset().table_name",
                            "type": "Expression"
                        },
                        "folderPath": "tables/parquet",
                        "container": "postgres"
                    },
                    "compressionCodec": "snappy"
                },
                "schema": []
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/Json1')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "AzureBlobStorage1",
                    "type": "LinkedServiceReference"
                },
                "parameters": {
                    "table_name": {
                        "type": "string"
                    }
                },
                "annotations": [],
                "type": "Json",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": {
                            "value": "@dataset().table_name",
                            "type": "Expression"
                        },
                        "folderPath": "tables/json",
                        "container": "postgres"
                    }
                },
                "schema": {}
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/DelimitedText2')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "AzureDataLakeStorage1",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobFSLocation",
                        "fileName": "tablelist.csv",
                        "folderPath": "control",
                        "fileSystem": "postgres"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": [
                    {
                        "name": "table_schema",
                        "type": "String"
                    },
                    {
                        "name": "table_name",
                        "type": "String"
                    },
                    {
                        "name": "enable",
                        "type": "String"
                    }
                ]
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/AzureSqlTable1')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "AzureSqlDatabase1",
                    "type": "LinkedServiceReference"
                },
                "parameters": {
                    "TableName": {
                        "type": "string"
                    },
                    "Schema": {
                        "type": "string"
                    }
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "inspection_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "external_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "inspection_date",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "completed_date",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "inspection_status_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "business_area",
                        "type": "nvarchar"
                    },
                    {
                        "name": "mine_no",
                        "type": "nvarchar"
                    },
                    {
                        "name": "inspector_idir",
                        "type": "nvarchar"
                    },
                    {
                        "name": "inspection_introduction",
                        "type": "nvarchar"
                    },
                    {
                        "name": "inspection_preamble",
                        "type": "nvarchar"
                    },
                    {
                        "name": "inspection_closing",
                        "type": "nvarchar"
                    },
                    {
                        "name": "officer_notes",
                        "type": "nvarchar"
                    },
                    {
                        "name": "inspection_report_sent_date",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "inspection_type_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "inspection_from_date",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "inspection_to_date",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "inspection_auth_source_application",
                        "type": "nvarchar"
                    },
                    {
                        "name": "inspection_auth_source_id",
                        "type": "nvarchar"
                    },
                    {
                        "name": "inspection_auth_status",
                        "type": "nvarchar"
                    },
                    {
                        "name": "inspection_auth_type",
                        "type": "nvarchar"
                    },
                    {
                        "name": "inspection_reason_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "inspection_substatus_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "assessment_sub_type",
                        "type": "nvarchar"
                    }
                ],
                "typeProperties": {
                    "schema": {
                        "value": "@dataset().Schema",
                        "type": "Expression"
                    },
                    "table": {
                        "value": "@dataset().TableName",
                        "type": "Expression"
                    }
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabase1')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/Parquet2')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "AzureBlobStorage1",
                    "type": "LinkedServiceReference"
                },
                "parameters": {
                    "FileName": {
                        "type": "string"
                    }
                },
                "annotations": [],
                "type": "Parquet",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": {
                            "value": "@dataset().FileName",
                            "type": "Expression"
                        },
                        "folderPath": "tables/parquet",
                        "container": "postgres"
                    },
                    "compressionCodec": "snappy"
                },
                "schema": [
                    {
                        "name": "inspection_id",
                        "type": "INT32"
                    },
                    {
                        "name": "external_id",
                        "type": "INT32"
                    },
                    {
                        "name": "inspection_date",
                        "type": "INT96"
                    },
                    {
                        "name": "completed_date",
                        "type": "INT96"
                    },
                    {
                        "name": "inspection_status_id",
                        "type": "INT32"
                    },
                    {
                        "name": "business_area",
                        "type": "UTF8"
                    },
                    {
                        "name": "mine_no",
                        "type": "UTF8"
                    },
                    {
                        "name": "inspector_idir",
                        "type": "UTF8"
                    },
                    {
                        "name": "inspection_introduction",
                        "type": "UTF8"
                    },
                    {
                        "name": "inspection_preamble",
                        "type": "UTF8"
                    },
                    {
                        "name": "inspection_closing",
                        "type": "UTF8"
                    },
                    {
                        "name": "officer_notes",
                        "type": "UTF8"
                    },
                    {
                        "name": "inspection_report_sent_date",
                        "type": "INT96"
                    },
                    {
                        "name": "inspection_type_id",
                        "type": "INT32"
                    },
                    {
                        "name": "inspection_from_date",
                        "type": "INT96"
                    },
                    {
                        "name": "inspection_to_date",
                        "type": "INT96"
                    },
                    {
                        "name": "inspection_auth_source_application",
                        "type": "UTF8"
                    },
                    {
                        "name": "inspection_auth_source_id",
                        "type": "UTF8"
                    },
                    {
                        "name": "inspection_auth_status",
                        "type": "UTF8"
                    },
                    {
                        "name": "inspection_auth_type",
                        "type": "UTF8"
                    },
                    {
                        "name": "inspection_reason_id",
                        "type": "INT32"
                    },
                    {
                        "name": "inspection_substatus_id",
                        "type": "INT32"
                    },
                    {
                        "name": "assessment_sub_type",
                        "type": "UTF8"
                    }
                ]
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/AzurePostgreSql1')]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "2018-06-01",
            "properties": {
                "annotations": [],
                "type": "AzurePostgreSql",
                "typeProperties": {
                    "connectionString": "[parameters('AzurePostgreSql1_connectionString')]"
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/AzureBlobStorage1')]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "2018-06-01",
            "properties": {
                "annotations": [],
                "type": "AzureBlobStorage",
                "typeProperties": {
                    "connectionString": "[parameters('AzureBlobStorage1_connectionString')]"
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/AzureDataLakeStorage1')]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "2018-06-01",
            "properties": {
                "annotations": [],
                "type": "AzureBlobFS",
                "typeProperties": {
                    "url": "[parameters('AzureDataLakeStorage1_properties_typeProperties_url')]",
                    "accountKey": {
                        "type": "SecureString",
                        "value": "[parameters('AzureDataLakeStorage1_accountKey')]"
                    }
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/AzureSqlDatabase1')]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "2018-06-01",
            "properties": {
                "annotations": [],
                "type": "AzureSqlDatabase",
                "typeProperties": {
                    "server": "[parameters('AzureSqlDatabase1_properties_typeProperties_server')]",
                    "database": "[parameters('AzureSqlDatabase1_properties_typeProperties_database')]",
                    "encrypt": "optional",
                    "trustServerCertificate": false,
                    "authenticationType": "SQL",
                    "userName": "[parameters('AzureSqlDatabase1_properties_typeProperties_userName')]",
                    "password": {
                        "type": "SecureString",
                        "value": "[parameters('AzureSqlDatabase1_password')]"
                    }
                },
                "connectVia": {
                    "referenceName": "shir-adf-d-ce-01",
                    "type": "IntegrationRuntimeReference"
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/integrationRuntimes/shir-adf-d-ce-01')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/shir-adf-d-ce-01')]",
            "type": "Microsoft.DataFactory/factories/integrationRuntimes",
            "apiVersion": "2018-06-01",
            "properties": {
                "type": "SelfHosted",
                "typeProperties": {}
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/CopyTableList')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Copy_MDS_Tables",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzurePostgreSqlSource",
                                "query": "SELECT table_schema, table_name, 1 as Enable\nFROM information_schema.tables\nWHERE table_type = 'BASE TABLE' ;",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "table_schema",
                                            "type": "String",
                                            "physicalType": "name"
                                        },
                                        "sink": {
                                            "name": "table_schema",
                                            "type": "String",
                                            "physicalType": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "table_name",
                                            "type": "String",
                                            "physicalType": "name"
                                        },
                                        "sink": {
                                            "name": "table_name",
                                            "type": "String",
                                            "physicalType": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "enable",
                                            "type": "Int32",
                                            "physicalType": "integer"
                                        },
                                        "sink": {
                                            "name": "enable",
                                            "type": "String",
                                            "physicalType": "String"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzurePostgreSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedText1",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-10-30T17:36:30Z"
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/AzurePostgreSqlTable1')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedText1')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/BulkCopuFromDBToLakeParquet')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "List Tables",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "dataset": {
                                "referenceName": "DelimitedText1",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "firstRowOnly": false
                        }
                    },
                    {
                        "name": "ForEach1",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Filter Enabled",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Filter Enabled').output.value",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "Copy table",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "0.12:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "AzurePostgreSqlSource",
                                            "query": {
                                                "value": "@concat('select ',item().column_list,' from ',item().table_schema,'.', item().table_name)",
                                                "type": "Expression"
                                            },
                                            "partitionOption": "None"
                                        },
                                        "sink": {
                                            "type": "ParquetSink",
                                            "storeSettings": {
                                                "type": "AzureBlobStorageWriteSettings"
                                            },
                                            "formatSettings": {
                                                "type": "ParquetWriteSettings"
                                            }
                                        },
                                        "enableStaging": false,
                                        "translator": {
                                            "type": "TabularTranslator",
                                            "typeConversion": true,
                                            "typeConversionSettings": {
                                                "allowDataTruncation": true,
                                                "treatBooleanAsNumber": false
                                            }
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "AzurePostgreSqlTable1",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "Parquet1",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "table_name": {
                                                    "value": "@concat(item().table_schema,'.', item().table_name,'.parquet')",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    },
                    {
                        "name": "Filter Enabled",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "List Tables",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('List Tables').output.value",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@equals(item().enable, '1')",
                                "type": "Expression"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-11-27T20:23:45Z"
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/DelimitedText1')]",
                "[concat(variables('factoryId'), '/datasets/AzurePostgreSqlTable1')]",
                "[concat(variables('factoryId'), '/datasets/Parquet1')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/CopyTableListToXlsx')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Copy_MDS_Tables",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzurePostgreSqlSource",
                                "query": "SELECT table_schema, table_name, 1 as Enable\nFROM information_schema.tables\nWHERE table_type = 'BASE TABLE' ;",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "table_schema",
                                            "type": "String",
                                            "physicalType": "name"
                                        },
                                        "sink": {
                                            "name": "table_schema",
                                            "type": "String",
                                            "physicalType": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "table_name",
                                            "type": "String",
                                            "physicalType": "name"
                                        },
                                        "sink": {
                                            "name": "table_name",
                                            "type": "String",
                                            "physicalType": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "enable",
                                            "type": "Int32",
                                            "physicalType": "integer"
                                        },
                                        "sink": {
                                            "name": "enable",
                                            "type": "String",
                                            "physicalType": "String"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzurePostgreSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedText2",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-10-31T16:34:22Z"
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/AzurePostgreSqlTable1')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedText2')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/Load MDP-DWH Dimensions')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Copy DimMine",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ParquetSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "ParquetReadSettings"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "MineNo"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "mine_guid",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "Mine_Guid",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_no",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "MineNo",
                                            "type": "String",
                                            "physicalType": "nchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_name",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "MineName",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_note",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "MineNote",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "major_mine_ind",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEN"
                                        },
                                        "sink": {
                                            "name": "MajorMineFlag",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "deleted_ind",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEAN"
                                        },
                                        "sink": {
                                            "name": "DeletedInd",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "union_ind",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEAN"
                                        },
                                        "sink": {
                                            "name": "UnionInd",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ohsc_ind",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEAN"
                                        },
                                        "sink": {
                                            "name": "OhcsInd",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_region",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "MineRegion",
                                            "type": "String",
                                            "physicalType": "nchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "latitude",
                                            "type": "Decimal",
                                            "physicalType": "DECIMAL",
                                            "scale": 18,
                                            "precision": 38
                                        },
                                        "sink": {
                                            "name": "Latitude",
                                            "type": "Double",
                                            "physicalType": "float"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "longitude",
                                            "type": "Decimal",
                                            "physicalType": "DECIMAL",
                                            "scale": 18,
                                            "precision": 38
                                        },
                                        "sink": {
                                            "name": "Longitude",
                                            "type": "Double",
                                            "physicalType": "float"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_location_description",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "MineLocationDescription",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "geom",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "Geom",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "legacy_mms_mine_status",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "LegacyMmsMineStatus",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "exemption_fee_status_code",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "ExemptionFeeStatusCode",
                                            "type": "String",
                                            "physicalType": "char"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "exemption_fee_status_note",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "ExemptionFeeStatusNote",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mms_alias",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "MmsAlias",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "government_agency_type_code",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "GovernmentAgencyTypeCode",
                                            "type": "String",
                                            "physicalType": "nchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_no_sequence",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "MineNoSequence",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "number_of_contractors",
                                            "type": "Decimal",
                                            "physicalType": "DECIMAL",
                                            "scale": 18,
                                            "precision": 38
                                        },
                                        "sink": {
                                            "name": "NumberOfContractors",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "number_of_mine_employees",
                                            "type": "Decimal",
                                            "physicalType": "DECIMAL",
                                            "scale": 18,
                                            "precision": 38
                                        },
                                        "sink": {
                                            "name": "NumberOfMineEmployees",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_timezone",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "MineTimezone",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_user",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "CreateUser",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "update_user",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "UpdateUser",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "Create_Timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "update_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "Update_Timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Parquet1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "table_name": "public.mine.parquet"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimMine",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "Copy DimInspectionStatus",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ParquetSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "ParquetReadSettings"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "inspection_status_Id"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "inspection_status_id",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "inspection_status_Id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_status_code",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "InspectionStatus",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_status_description",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "InspectionStatusDescription",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Parquet1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "table_name": "nris.inspection_status.parquet"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimInspectionStatus",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "DimInspectionSubStatus",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ParquetSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "ParquetReadSettings"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "inspection_substatus_id"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "inspection_substatus_id",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "inspection_substatus_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_substatus_code",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "InspectionSubStatus",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_substatus_description",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "InspectionSubStatusDescription",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Parquet1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "table_name": "nris.inspection_substatus.parquet"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimInspectionSubStatus",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "Copy DimuserDetail",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ParquetSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "ParquetReadSettings"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "core_user_id"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "idir_user_detail_id",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "idir_user_detail_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "core_user_id",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "core_user_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bcgov_guid",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "bcgov_guid",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "username",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "UserNname",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "title",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "Title",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "city",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "City",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "department",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "Department",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_user",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "create_user",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "create_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "update_user",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "update_user",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "update_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "update_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Parquet1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "table_name": "public.idir_user_detail.parquet"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimUserDetail",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "Copy DimInspectionType",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ParquetSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "ParquetReadSettings"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "InspectionType"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "inspection_type_code",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "InspectionType",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_type_description",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "InspectionTypeDescription",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Parquet1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "table_name": "nris.inspection_type.parquet"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimInspectionType",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "Copy Inspection stg",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ParquetSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "ParquetReadSettings"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "truncate table stg.Inspection",
                                "writeBehavior": "insert",
                                "sqlWriterUseTableLock": false,
                                "tableOption": "autoCreate",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "inspection_id",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "inspection_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "external_id",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "external_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_date",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "inspection_date",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "completed_date",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "completed_date",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_status_id",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "inspection_status_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "business_area",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "business_area",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_no",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "mine_no",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspector_idir",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "inspector_idir",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_introduction",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "inspection_introduction",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_preamble",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "inspection_preamble",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_closing",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "inspection_closing",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "officer_notes",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "officer_notes",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_report_sent_date",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "inspection_report_sent_date",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_type_id",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "inspection_type_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_from_date",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "inspection_from_date",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_to_date",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "inspection_to_date",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_auth_source_application",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "inspection_auth_source_application",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_auth_source_id",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "inspection_auth_source_id",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_auth_status",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "inspection_auth_status",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_auth_type",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "inspection_auth_type",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_reason_id",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "inspection_reason_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_substatus_id",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "inspection_substatus_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "assessment_sub_type",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "assessment_sub_type",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Parquet1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "table_name": "nris.inspection.parquet"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "Inspection",
                                    "Schema": "stg"
                                }
                            }
                        ]
                    },
                    {
                        "name": "Copy DimInspectionNote",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy Inspection stg",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT  \n    [inspection_id],\n    [inspection_introduction],\n    [inspection_preamble],\n    [inspection_closing],\n    [officer_notes]\nFROM \n    [stg].[Inspection]\nWHERE \n    ISNULL([inspection_introduction], '') <> '' \n    OR ISNULL([inspection_preamble], '') <> '' \n    OR ISNULL([inspection_closing], '') <> '' \n    OR ISNULL([officer_notes], '') <> '';\n",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "inspection_id"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "inspection_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "inspection_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_introduction",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "InspectionIntroduction",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_preamble",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "InspectionPreamble",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_closing",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "InspectionClosing",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "officer_notes",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "InspectionOficerNote",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimInspectionNote",
                                    "Schema": "dbo"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimInspectionNote",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "Copy DimInspectionAssesmentSubType",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy Inspection stg",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": " SELECT DISTINCT \n    [assessment_sub_type],\n    CHECKSUM([assessment_sub_type]) AS assessment_sub_type_hash\nFROM \n    [stg].[Inspection]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "assessment_sub_type_hash"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "assessment_sub_type",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "InspectionAssesmentSubType",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "assessment_sub_type_hash",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "assessment_sub_type_hash",
                                            "type": "Int64",
                                            "physicalType": "bigint"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimInspectionAssesmentSubType",
                                    "Schema": "dbo"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimInspectionAssesmentSubType",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "Copy DimInspectionAuthType",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy Inspection stg",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "    SELECT DISTINCT\n      [inspection_auth_type]\n      ,CHECKSUM([inspection_auth_type]) AS inspection_auth_type_hash\n  FROM [stg].[Inspection]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "InspectionAuthTypeHash"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "inspection_auth_type_hash",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "InspectionAuthTypeHash",
                                            "type": "Int64",
                                            "physicalType": "bigint"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_auth_type",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "InspectionAuthType",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimInspectionAuthType",
                                    "Schema": "dbo"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimInspectionAuthType",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "Copy DimInspectionAuthStatus",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy Inspection stg",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "\n  SELECT DISTINCT\n      inspection_auth_status\n      ,CHECKSUM(inspection_auth_status) AS inspection_auth_status_hash\n  FROM [stg].[Inspection]\n  where ISNULL(inspection_auth_status,'')<>''",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "InspectionAuthStatusHash"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "inspection_auth_status",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "InspectionAuthStatus",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_auth_status_hash",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "InspectionAuthStatusHash",
                                            "type": "Int64",
                                            "physicalType": "bigint"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimInspectionAuthStatus",
                                    "Schema": "dbo"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimInspectionAuthStatus",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "DimInspectionAuthSource",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy Inspection stg",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": " SELECT DISTINCT \n    [inspection_auth_source_id],\n    CHECKSUM([inspection_auth_source_id]) AS inspection_auth_source_id_hash\nFROM \n    [stg].[Inspection]\nWHERE ISNULL(inspection_auth_source_id,'')<>''",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "InspectionAuthSource_hash"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "inspection_auth_source_id_hash",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "InspectionAuthSource_hash",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_auth_source_id",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "InspectionAuthSource",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimInspectionAuthSource",
                                    "Schema": "dbo"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimInspectionAuthSource",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "Copy Incident stg",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ParquetSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "ParquetReadSettings"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "truncate table stg.Incident",
                                "writeBehavior": "insert",
                                "sqlWriterUseTableLock": false,
                                "tableOption": "autoCreate",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "mine_incident_id",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "mine_incident_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_incident_id_year",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "mine_incident_id_year",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_incident_guid",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "mine_incident_guid",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_guid",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "mine_guid",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "incident_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "incident_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "incident_description",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "incident_description",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "reported_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "reported_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_user",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "create_user",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "create_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "update_user",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "update_user",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "update_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "update_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "determination_type_code",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "determination_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "status_code",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "status_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "reported_by_name",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "reported_by_name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "reported_by_phone_no",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "reported_by_phone_no",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "reported_by_phone_ext",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "reported_by_phone_ext",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "reported_by_email",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "reported_by_email",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "reported_to_inspector_party_guid",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "reported_to_inspector_party_guid",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "responsible_inspector_party_guid",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "responsible_inspector_party_guid",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "determination_inspector_party_guid",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "determination_inspector_party_guid",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "number_of_fatalities",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "number_of_fatalities",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "number_of_injuries",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "number_of_injuries",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "emergency_services_called",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEAN"
                                        },
                                        "sink": {
                                            "name": "emergency_services_called",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "followup_inspection",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEAN"
                                        },
                                        "sink": {
                                            "name": "followup_inspection",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "followup_investigation_type_code",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "followup_investigation_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "followup_inspection_date",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "followup_inspection_date",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_incident_no",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "mine_incident_no",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mms_insp_cd",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "mms_insp_cd",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "proponent_incident_no",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "proponent_incident_no",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_determination_representative",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "mine_determination_representative",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_determination_type_code",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "mine_determination_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "deleted_ind",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEAN"
                                        },
                                        "sink": {
                                            "name": "deleted_ind",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "immediate_measures_taken",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "immediate_measures_taken",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "injuries_description",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "injuries_description",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_worker_rep_name",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "johsc_worker_rep_name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_worker_rep_contacted",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEAN"
                                        },
                                        "sink": {
                                            "name": "johsc_worker_rep_contacted",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_management_rep_name",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "johsc_management_rep_name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_management_rep_contacted",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEAN"
                                        },
                                        "sink": {
                                            "name": "johsc_management_rep_contacted",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_worker_rep_contact_method",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "johsc_worker_rep_contact_method",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_worker_rep_contact_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "johsc_worker_rep_contact_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_management_rep_contact_method",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "johsc_management_rep_contact_method",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_management_rep_contact_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "johsc_management_rep_contact_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "reported_to_inspector_contacted",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEAN"
                                        },
                                        "sink": {
                                            "name": "reported_to_inspector_contacted",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "reported_to_inspector_contact_method",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "reported_to_inspector_contact_method",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "verbal_notification_provided",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEAN"
                                        },
                                        "sink": {
                                            "name": "verbal_notification_provided",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "verbal_notification_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "verbal_notification_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "incident_location",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "incident_location",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "incident_timezone",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "incident_timezone",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tz_legacy",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEAN"
                                        },
                                        "sink": {
                                            "name": "tz_legacy",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Parquet1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "table_name": "public.mine_incident.parquet"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "Incident",
                                    "Schema": "stg"
                                }
                            }
                        ]
                    },
                    {
                        "name": "DimIncidentType",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy Incident stg",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT [Incident_Type_Code],  CHECKSUM([Incident_Type_Code]) AS Incident_Type_Code_hash\nFROM\n(\nselect DISTINCT [followup_investigation_type_code] AS [Incident_Type_Code] FROM [stg].[Incident] WHERE ISNULL([followup_investigation_type_code],'')<>''\nUNION\nselect  [determination_type_code] AS [Incident_Type_Code] FROM [stg].[Incident] WHERE ISNULL([determination_type_code],'')<>''\nUNION\nselect  [mine_determination_type_code] AS [Incident_Type_Code] FROM [stg].[Incident] WHERE ISNULL([mine_determination_type_code],'')<>''\n) U",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "Incident_Type_Code_hash"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "Incident_Type_Code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Incident_Type_Code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Incident_Type_Code_hash",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "Incident_Type_Code_hash",
                                            "type": "Int64",
                                            "physicalType": "bigint"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimIncidentType",
                                    "Schema": "dbo"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimIncidentType",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "DimIncidentStatus",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy Incident stg",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT DISTINCT [status_code], CHECKSUM([status_code]) AS [status_code_hash]  FROM [stg].[Incident]\nWHERE ISNULL([status_code],'')<>''",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "status_code_hash"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "status_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Incident_Status_Code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "status_code_hash",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "status_code_hash",
                                            "type": "Int64",
                                            "physicalType": "bigint"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimIncidentStatus",
                                    "Schema": "dbo"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimIncidentStatus",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "DimIncidentReporter",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy Incident stg",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT DISTINCT \n[mine_incident_id]\n,[reported_by_name]\n,[reported_by_phone_no]\n,[reported_by_phone_ext]\n,[reported_by_email]\n,[verbal_notification_provided]\n,[verbal_notification_timestamp]\n,[reported_to_inspector_contact_method]\n,[reported_to_inspector_contacted]\n,[emergency_services_called]\nFROM [stg].[Incident]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "mine_incident_id"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "reported_by_name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "IncidentReporterName",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_incident_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "mine_incident_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "reported_by_phone_no",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "IncidentReporterPhoneNo",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "reported_by_phone_ext",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "IncidentReporterPhoneExt",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "reported_by_email",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "IncidentReporterEmail",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "verbal_notification_provided",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        },
                                        "sink": {
                                            "name": "VerbalNotificationProvided",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "verbal_notification_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "VerbalNotificationTimestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "reported_to_inspector_contact_method",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "ContactMethod",
                                            "type": "String",
                                            "physicalType": "nchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "reported_to_inspector_contacted",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        },
                                        "sink": {
                                            "name": "ReportedToInspector",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "emergency_services_called",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        },
                                        "sink": {
                                            "name": "EmergencyServiceCalled",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimIncidentReporter",
                                    "Schema": "dbo"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimIncidentReporter",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "DimIncidentLocation",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy Incident stg",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT DISTINCT \n      [incident_location]\n      ,CHECKSUM([incident_location]) as [incident_location_hash]\nFROM [stg].[Incident]\nWHERE ISNULL([incident_location],'')<>''",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "incident_location_hash"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "incident_location",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "IncidentLocation",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "incident_location_hash",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "Incident_location_hash",
                                            "type": "Int64",
                                            "physicalType": "bigint"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimIncidentLocation",
                                    "Schema": "dbo"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimIncidentLocation",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "DimIncidentDescription",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy Incident stg",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT  \n[mine_incident_id]\n,incident_description\nFROM [stg].[Incident]\nWHERE ISNULL(incident_description,'')<>''",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "mine_incident_id"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "mine_incident_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "mine_incident_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "incident_description",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "IncidentDescription",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimIncidentReporter",
                                    "Schema": "dbo"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimIncidentDescription",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "DimIncidentJohsc",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy Incident stg",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT \n[mine_incident_id]\n,[johsc_worker_rep_name]\n,[johsc_worker_rep_contacted]\n,[johsc_management_rep_name]\n,[johsc_management_rep_contacted]\n,[johsc_worker_rep_contact_method]\n,[johsc_worker_rep_contact_timestamp]\n,[johsc_management_rep_contact_method]\n,[johsc_management_rep_contact_timestamp]\nFROM [stg].[Incident]\nWHERE\n[johsc_worker_rep_name] IS NOT NULL\nOR [johsc_worker_rep_contacted] IS NOT NULL\nOR [johsc_management_rep_name] IS NOT NULL\nOR [johsc_management_rep_contacted] IS NOT NULL\nOR [johsc_worker_rep_contact_method] IS NOT NULL\nOR [johsc_worker_rep_contact_timestamp] IS NOT NULL\nOR [johsc_management_rep_contact_method] IS NOT NULL\nOR [johsc_management_rep_contact_timestamp] IS NOT NULL",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "mine_incident_id"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "mine_incident_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "mine_incident_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_worker_rep_name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "JohscWorkerRepName",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_worker_rep_contacted",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        },
                                        "sink": {
                                            "name": "JohscWorkerRepContacted",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_management_rep_name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "JohscManagementRepName",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_management_rep_contacted",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        },
                                        "sink": {
                                            "name": "JohscManagementRepContacted",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_worker_rep_contact_method",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "JohscWorkerRepContactMethod",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_worker_rep_contact_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "JobhscWorkerRepContactTimestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_management_rep_contact_method",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "JohscManagementRepContactMethod",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "johsc_management_rep_contact_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "JobhscManagementRepContactTimestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimIncidentJohsc",
                                    "Schema": "dbo"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimIncidentJohsc",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "DimIncidentInjuriesDescription",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy Incident stg",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT  DISTINCT\n--[mine_incident_id]\nLTRIM(RTRIM(injuries_description)) AS injuries_description,\nCHECKSUM(LTRIM(RTRIM(injuries_description))) AS injuries_description_hash\nFROM [stg].[Incident]\nWHERE ISNULL(injuries_description,'')<>''",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "injuries_description_hash"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "injuries_description",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "IncidentInjuriesDescription",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "injuries_description_hash",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "injuries_description_hash",
                                            "type": "Int64",
                                            "physicalType": "bigint"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimIncidentInjuriesDescription",
                                    "Schema": "dbo"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimIncidentInjuriesDescription",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "Copy Permit stg",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ParquetSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "ParquetReadSettings"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "truncate table stg.Permit",
                                "writeBehavior": "insert",
                                "sqlWriterUseTableLock": false,
                                "tableOption": "autoCreate",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "permit_guid",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "permit_guid",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_no",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "permit_no",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_status_code",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "permit_status_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_user",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "create_user",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "create_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "update_user",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "update_user",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "update_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "update_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_id",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "permit_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "deleted_ind",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEAN"
                                        },
                                        "sink": {
                                            "name": "deleted_ind",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "project_id",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "project_id",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_no_sequence",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "permit_no_sequence",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "is_exploration",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEAN"
                                        },
                                        "sink": {
                                            "name": "is_exploration",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "remaining_static_liability",
                                            "type": "Decimal",
                                            "physicalType": "DECIMAL",
                                            "scale": 18,
                                            "precision": 38
                                        },
                                        "sink": {
                                            "name": "remaining_static_liability",
                                            "type": "Decimal",
                                            "physicalType": "decimal",
                                            "scale": 18,
                                            "precision": 38
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "exemption_fee_status_code",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "exemption_fee_status_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "exemption_fee_status_note",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "exemption_fee_status_note",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "status_changed_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "status_changed_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mines_act_permit_vc_locked",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEAN"
                                        },
                                        "sink": {
                                            "name": "mines_act_permit_vc_locked",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Parquet1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "table_name": "public.permit.parquet"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "Permit",
                                    "Schema": "stg"
                                }
                            }
                        ]
                    },
                    {
                        "name": "DimPermitExemptFeeStatus",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ParquetSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "ParquetReadSettings"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "PermitExemptFeeStatusCode"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "exemption_fee_status_code",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "PermitExemptFeeStatusCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "description",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "PermitExemptFeeStatusCodeDescription",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "Create_Timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "update_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "Update_Timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Parquet1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "table_name": "public.exemption_fee_status.parquet"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimPermitExemptFeeStatus",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "DimPermitStatus",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ParquetSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "ParquetReadSettings"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "PermitStatusCode"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "permit_status_code",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "PermitStatusCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "description",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "PermitStatusDescription",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "Create_Timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "update_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "Update_Timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Parquet1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "table_name": "public.permit_status_code.parquet"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimPermitStatus",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "mine_permit_xref stg",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ParquetSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "ParquetReadSettings"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "truncate table stg.mine_permit_xref",
                                "writeBehavior": "insert",
                                "sqlWriterUseTableLock": false,
                                "tableOption": "autoCreate",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "mine_guid",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "mine_guid",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_id",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "permit_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "start_date",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "start_date",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "end_date",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "end_date",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "deleted_ind",
                                            "type": "Boolean",
                                            "physicalType": "BOOLEAN"
                                        },
                                        "sink": {
                                            "name": "deleted_ind",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_user",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "create_user",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "create_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "update_user",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "update_user",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "update_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "update_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Parquet1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "table_name": "public.mine_permit_xref.parquet"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "mine_permit_xref",
                                    "Schema": "stg"
                                }
                            }
                        ]
                    },
                    {
                        "name": "Copy DimMine_Ext",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy mine_summary_view",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT DISTINCT\n[mine_guid]\n,[mine_name]\n,[mine_number]\n,[mine_latitude]\n,[mine_longitude]\n,[government_agency_type_code]\n,[government_agency_type_d]\n,[mine_exemption_fee_status_note]\n,[mine_exemption_fee_status_code]\n,[mine_exemption_fee_status_d]\n,[operation_status]\n,[operation_status_code]\n,[mine_operation_status_code]\n,[mine_operation_status_reason_code]\n,[mine_operation_status_sub_reason_code]\n,[mine_operation_status_d]\n,[mine_operation_status_reason_d]\n,[mine_operation_status_sub_reason_d]\n,[mine_date]\n,[status_date]\n,[mine_tenure]\n,[mine_tenure_type_code]\n,[mine_commodity]\n,[mine_commodity_type_code]\n,[mine_disturbance]\n,[mine_disturbance_type_code]\n,[mine_region]\n,[major_mine_ind]\n,[bcmi_url]\n,[major_mine_d]\nFROM [stg].[mine_summary_view]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "MineGuid"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "tableOption": "autoCreate",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "mine_guid",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineGuid",
                                            "type": "Guid",
                                            "physicalType": "uniqueidentifier"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineName",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_number",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineNumber",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_latitude",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineLatitude",
                                            "type": "Double",
                                            "physicalType": "float"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_longitude",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineLongitude",
                                            "type": "Double",
                                            "physicalType": "float"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "government_agency_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "GovernmentAgencyTypeCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "government_agency_type_d",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "GovernmentAgencyTypeD",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_exemption_fee_status_note",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineExemptionFeeStatusNote",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_exemption_fee_status_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineExemptionFeeStatusCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_exemption_fee_status_d",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineExemptionFeeStatusD",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "operation_status",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "OperationStatus",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "operation_status_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "OperationStatusCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_operation_status_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineOperationStatusCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_operation_status_reason_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineOperationStatusReasonCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_operation_status_sub_reason_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineOperationStatusSubReasonCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_operation_status_d",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineOperationStatusD",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_operation_status_reason_d",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineOperationStatusReasonD",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_operation_status_sub_reason_d",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineOperationStatusSubReasonD",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_date",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineDate",
                                            "type": "DateTime",
                                            "physicalType": "date"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "status_date",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "StatusDate",
                                            "type": "DateTime",
                                            "physicalType": "date"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_tenure",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineTenure",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_tenure_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineTenureTypeCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_commodity",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineCommodity",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_commodity_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineCommodityTypeCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_disturbance",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineDisturbance",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_disturbance_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineDisturbanceTypeCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_region",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineRegion",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "major_mine_ind",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MajorMineInd",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bcmi_url",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "BCMIUrl",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "major_mine_d",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MajorMineD",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "v_Dim_mine_summary_view",
                                    "Schema": "stg"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimMineExt",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "Copy mine_summary_view",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ParquetSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "ParquetReadSettings"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "truncate table stg.mine_summary_view",
                                "writeBehavior": "insert",
                                "sqlWriterUseTableLock": false,
                                "tableOption": "autoCreate",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Parquet1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "table_name": "public.mine_summary_view.parquet"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "mine_summary_view",
                                    "Schema": "stg"
                                }
                            }
                        ]
                    },
                    {
                        "name": "Copy DimPermitDetail_copy1",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy mine_summary_view",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT \npermit_id,\n    MAX(permit_guid) AS permit_guid, \n    MAX(permit_no) AS permit_no,\n    MAX(permit_tenure) AS permit_tenure,\n    MAX(permit_tenure_type_code) AS permit_tenure_type_code,\n    MAX(permit_commodity) AS permit_commodity,\n    MAX(permit_commodity_type_code) AS permit_commodity_type_code,\n    MAX(permit_disturbance) AS permit_disturbance,\n    MAX(permit_disturbance_type_code) AS permit_disturbance_type_code,\n    MAX(permit_status_code) AS permit_status_code,\n    MAX(permit_status_changed_timestamp) AS permit_status_changed_timestamp,\n    MAX(permit_exemption_fee_status_code) AS permit_exemption_fee_status_code,\n    MAX(permit_exemption_fee_status_d) AS permit_exemption_fee_status_d,\n    MAX(permit_exemption_fee_status_note) AS permit_exemption_fee_status_note,\n    MAX(permittee_party_guid) AS permittee_party_guid,\n    MAX(permittee_first_name) AS permittee_first_name,\n    MAX(permittee_name) AS permittee_name,\n    MAX(permittee_address_suite) AS permittee_address_suite,\n    MAX(permittee_address_line_1) AS permittee_address_line_1,\n    MAX(permittee_address_line_2) AS permittee_address_line_2,\n    MAX(permittee_address_city) AS permittee_address_city,\n    MAX(permittee_address_post_code) AS permittee_address_post_code,\n    MAX(permittee_address_prov) AS permittee_address_prov\nFROM\n(\n    SELECT DISTINCT\n        permit_id, \n        permit_guid, \n        permit_no,\n        permit_tenure,\n        permit_tenure_type_code,\n        permit_commodity,\n        permit_commodity_type_code,\n        permit_disturbance,\n        permit_disturbance_type_code,\n        permit_status_code,\n        permit_status_changed_timestamp,\n        permit_exemption_fee_status_code,\n        permit_exemption_fee_status_d,\n        permit_exemption_fee_status_note,\n        permittee_party_guid,\n        permittee_first_name,\n        permittee_name,\n        permittee_address_suite,\n        permittee_address_line_1,\n        permittee_address_line_2,\n        permittee_address_city,\n        permittee_address_post_code,\n        permittee_address_prov\n    FROM [stg].[mine_summary_view] \n    WHERE permit_id is not null\n) s\nGROUP BY permit_id;",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "Permit_ID"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "tableOption": "autoCreate",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "permit_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "Permit_ID",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_guid",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Guid",
                                            "type": "Guid",
                                            "physicalType": "uniqueidentifier"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_no",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_No",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_tenure",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Tenure",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_tenure_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Tenure_Type_Code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_commodity",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Commodity",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_commodity_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Commodity_Type_Code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_disturbance",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Disturbance",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_disturbance_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Disturbance_Type_Code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_status_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Status_Code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_status_changed_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "Permit_Status_Changed_Timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_exemption_fee_status_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Exemption_Fee_Status_Code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_exemption_fee_status_d",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Exemption_Fee_Status_D",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_exemption_fee_status_note",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Exemption_Fee_Status_Note",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_party_guid",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Party_Guid",
                                            "type": "Guid",
                                            "physicalType": "uniqueidentifier"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_first_name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_First_Name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_address_suite",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Address_Suite",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_address_line_1",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Address_Line_1",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_address_line_2",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Address_Line_2",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_address_city",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Address_City",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_address_post_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Address_Post_Code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_address_prov",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Address_Prov",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "v_Dim_mine_summary_view",
                                    "Schema": "stg"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimPermitDetail",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-12-17T17:21:17Z"
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/Parquet1')]",
                "[concat(variables('factoryId'), '/datasets/AzureSqlTable1')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/Load MDP-DWH FactInspection')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Copy FactInspection",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "inspection_id"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "inspection_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "inspection_id",
                                            "type": "Int64",
                                            "physicalType": "bigint"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "InspectionStatus_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "InspectionStatus_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "InspectionSubStatus_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "InspectionSubStatus_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "InspectionType_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "InspectionType_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Mine_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "Mine_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MineExt_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "MineExt_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "User_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "User_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "InspectionDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "InspectionDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CompleetedDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "CompleetedDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "InspectionReportSentDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "InspectionReportSentDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "InspectionFromDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "InspectionFromDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "InspectionToDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "InspectionToDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "InspectionAuthStatus_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "InspectionAuthStatus_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "InspectionAuthType_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "InspectionAuthType_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "InspectionNote_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "InspectionNote_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "InspectionAssesmentSubType_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "InspectionAssesmentSubTyp_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "InspectionAuthSource_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "InspectionAuthSource_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_date",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "InspectionDate",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "completed_date",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "CompleetedDate",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_report_sent_date",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "InspectionReportSentDate",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_from_date",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "InspectionFromDate",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "inspection_to_date",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "InspectionToDate",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ETL_LastModified",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        },
                                        "sink": {
                                            "name": "ETL_LastModified",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "v_Inspection",
                                    "Schema": "stg"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "FactInspection",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-12-13T19:34:33Z"
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/AzureSqlTable1')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/MDP-DWH_Refresh')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Bulk Copy From NDS DB ToLake Parquet",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "BulkCopuFromDBToLakeParquet",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {}
                        }
                    },
                    {
                        "name": "Load MDP-DWH Dimensions",
                        "type": "ExecutePipeline",
                        "dependsOn": [
                            {
                                "activity": "Bulk Copy From NDS DB ToLake Parquet",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "Load MDP-DWH Dimensions",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {}
                        }
                    },
                    {
                        "name": "Load MDP-DWH FactInspection",
                        "type": "ExecutePipeline",
                        "dependsOn": [
                            {
                                "activity": "Load MDP-DWH Dimensions",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "Load MDP-DWH FactInspection",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {}
                        }
                    },
                    {
                        "name": "Load MDP-DWH FactIncident",
                        "type": "ExecutePipeline",
                        "dependsOn": [
                            {
                                "activity": "Load MDP-DWH Dimensions",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "Load MDP-DWH FactIncident",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {}
                        }
                    },
                    {
                        "name": "Load MDP-DWH FactPermit",
                        "type": "ExecutePipeline",
                        "dependsOn": [
                            {
                                "activity": "Load MDP-DWH Dimensions",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "Load MDP-DWH FactPermit",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {}
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-12-17T17:21:18Z"
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/pipelines/BulkCopuFromDBToLakeParquet')]",
                "[concat(variables('factoryId'), '/pipelines/Load MDP-DWH Dimensions')]",
                "[concat(variables('factoryId'), '/pipelines/Load MDP-DWH FactInspection')]",
                "[concat(variables('factoryId'), '/pipelines/Load MDP-DWH FactIncident')]",
                "[concat(variables('factoryId'), '/pipelines/Load MDP-DWH FactPermit')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/Load MDP-DWH FactIncident')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Copy FactIncident",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "MineIncidentId"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "MineIncidentId",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "MineIncidentId",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Mine_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "Mine_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MineExt_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "MineExt_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IncidentType_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "IncidentType_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IncidentLocation_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "IncidentLocation_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IncidentDescription_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "IncidentDescription_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IncidentInjuriesDescription_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "IncidentInjuriesDescription_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IncidentJohsc_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "IncidentJohsc_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IncidentReporter_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "IncidentReporter_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IncidentStatus_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "IncidentStatus_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IncidentDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "IncidentDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "FollowUpInspectionDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "FollowUpInspectionDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DeletedInd",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        },
                                        "sink": {
                                            "name": "DeletedInd",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IncidentTimeStamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "IncidentTimeStamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IncidentReportedTimeStamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "IncidentReportedTimeStamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "FollowUpInspectionDate",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "FollowUpInspectionDate",
                                            "type": "DateTime",
                                            "physicalType": "date"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NumberOfFatalities",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "NumberOfFatalities",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NumberOfInjuries",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "NumberOfInjuries",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "Create_Timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "update_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "Update_Timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ETL_LastModified",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        },
                                        "sink": {
                                            "name": "ETL_LastModified",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "v_Incident",
                                    "Schema": "stg"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "FactIncident",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-12-13T19:31:25Z"
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/AzureSqlTable1')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/Load MDP-DWH FactPermit')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Copy FactPermit",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "permit_id"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "permit_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "Permit_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MineExt_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "MineExt_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CreateDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "CreateDate_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PermitDetail_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "PermitDetail_Key",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "Create_Timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ETL_LastModified",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        },
                                        "sink": {
                                            "name": "ETL_LastModified",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "v_Permit",
                                    "Schema": "stg"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "FactPermit",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-12-17T17:12:52Z"
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/AzureSqlTable1')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/Copy stg mine_summary_view')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Copy DimMine_Ext",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ParquetSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "ParquetReadSettings"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "truncate table stg.mine_summary_view",
                                "writeBehavior": "insert",
                                "sqlWriterUseTableLock": false,
                                "tableOption": "autoCreate",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Parquet1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "table_name": "public.mine_summary_view.parquet"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "mine_summary_view",
                                    "Schema": "stg"
                                }
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-12-12T20:46:28Z"
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/Parquet1')]",
                "[concat(variables('factoryId'), '/datasets/AzureSqlTable1')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/copy nris_raw_data stg')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "copy nris_raw_data stg",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ParquetSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "ParquetReadSettings"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "insert",
                                "sqlWriterUseTableLock": false,
                                "tableOption": "autoCreate",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "id",
                                            "type": "Int32",
                                            "physicalType": "INT32"
                                        },
                                        "sink": {
                                            "name": "id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "nris_data",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        },
                                        "sink": {
                                            "name": "nris_data",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "input_date",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "input_date",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "processed_date",
                                            "type": "DateTime",
                                            "physicalType": "INT96"
                                        },
                                        "sink": {
                                            "name": "processed_date",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Parquet1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "table_name": "nris.nris_raw_data.parquet"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "nris_raw_data",
                                    "Schema": "stg"
                                }
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-12-13T16:39:54Z"
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/Parquet1')]",
                "[concat(variables('factoryId'), '/datasets/AzureSqlTable1')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/Test table load')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Copy DimMine_Ext",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT DISTINCT\n[mine_guid]\n,[mine_name]\n,[mine_number]\n,[mine_latitude]\n,[mine_longitude]\n,[government_agency_type_code]\n,[government_agency_type_d]\n,[mine_exemption_fee_status_note]\n,[mine_exemption_fee_status_code]\n,[mine_exemption_fee_status_d]\n,[operation_status]\n,[operation_status_code]\n,[mine_operation_status_code]\n,[mine_operation_status_reason_code]\n,[mine_operation_status_sub_reason_code]\n,[mine_operation_status_d]\n,[mine_operation_status_reason_d]\n,[mine_operation_status_sub_reason_d]\n,[mine_date]\n,[status_date]\n,[mine_tenure]\n,[mine_tenure_type_code]\n,[mine_commodity]\n,[mine_commodity_type_code]\n,[mine_disturbance]\n,[mine_disturbance_type_code]\n,[mine_region]\n,[major_mine_ind]\n,[bcmi_url]\n,[major_mine_d]\nFROM [stg].[mine_summary_view]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "MineGuid"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "tableOption": "autoCreate",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "mine_guid",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineGuid",
                                            "type": "Guid",
                                            "physicalType": "uniqueidentifier"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineName",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_number",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineNumber",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_latitude",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineLatitude",
                                            "type": "Double",
                                            "physicalType": "float"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_longitude",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineLongitude",
                                            "type": "Double",
                                            "physicalType": "float"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "government_agency_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "GovernmentAgencyTypeCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "government_agency_type_d",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "GovernmentAgencyTypeD",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_exemption_fee_status_note",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineExemptionFeeStatusNote",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_exemption_fee_status_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineExemptionFeeStatusCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_exemption_fee_status_d",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineExemptionFeeStatusD",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "operation_status",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "OperationStatus",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "operation_status_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "OperationStatusCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_operation_status_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineOperationStatusCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_operation_status_reason_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineOperationStatusReasonCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_operation_status_sub_reason_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineOperationStatusSubReasonCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_operation_status_d",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineOperationStatusD",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_operation_status_reason_d",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineOperationStatusReasonD",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_operation_status_sub_reason_d",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineOperationStatusSubReasonD",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_date",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineDate",
                                            "type": "DateTime",
                                            "physicalType": "date"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "status_date",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "StatusDate",
                                            "type": "DateTime",
                                            "physicalType": "date"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_tenure",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineTenure",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_tenure_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineTenureTypeCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_commodity",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineCommodity",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_commodity_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineCommodityTypeCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_disturbance",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineDisturbance",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_disturbance_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineDisturbanceTypeCode",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mine_region",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MineRegion",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "major_mine_ind",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MajorMineInd",
                                            "type": "Boolean",
                                            "physicalType": "bit"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bcmi_url",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "BCMIUrl",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "major_mine_d",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "MajorMineD",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "v_Dim_mine_summary_view",
                                    "Schema": "stg"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimMineExt",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    },
                    {
                        "name": "Copy DimPermitDetail",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT \npermit_id,\n    MAX(permit_guid) AS permit_guid, \n    MAX(permit_no) AS permit_no,\n    MAX(permit_tenure) AS permit_tenure,\n    MAX(permit_tenure_type_code) AS permit_tenure_type_code,\n    MAX(permit_commodity) AS permit_commodity,\n    MAX(permit_commodity_type_code) AS permit_commodity_type_code,\n    MAX(permit_disturbance) AS permit_disturbance,\n    MAX(permit_disturbance_type_code) AS permit_disturbance_type_code,\n    MAX(permit_status_code) AS permit_status_code,\n    MAX(permit_status_changed_timestamp) AS permit_status_changed_timestamp,\n    MAX(permit_exemption_fee_status_code) AS permit_exemption_fee_status_code,\n    MAX(permit_exemption_fee_status_d) AS permit_exemption_fee_status_d,\n    MAX(permit_exemption_fee_status_note) AS permit_exemption_fee_status_note,\n    MAX(permittee_party_guid) AS permittee_party_guid,\n    MAX(permittee_first_name) AS permittee_first_name,\n    MAX(permittee_name) AS permittee_name,\n    MAX(permittee_address_suite) AS permittee_address_suite,\n    MAX(permittee_address_line_1) AS permittee_address_line_1,\n    MAX(permittee_address_line_2) AS permittee_address_line_2,\n    MAX(permittee_address_city) AS permittee_address_city,\n    MAX(permittee_address_post_code) AS permittee_address_post_code,\n    MAX(permittee_address_prov) AS permittee_address_prov\nFROM\n(\n    SELECT DISTINCT\n        permit_id, \n        permit_guid, \n        permit_no,\n        permit_tenure,\n        permit_tenure_type_code,\n        permit_commodity,\n        permit_commodity_type_code,\n        permit_disturbance,\n        permit_disturbance_type_code,\n        permit_status_code,\n        permit_status_changed_timestamp,\n        permit_exemption_fee_status_code,\n        permit_exemption_fee_status_d,\n        permit_exemption_fee_status_note,\n        permittee_party_guid,\n        permittee_first_name,\n        permittee_name,\n        permittee_address_suite,\n        permittee_address_line_1,\n        permittee_address_line_2,\n        permittee_address_city,\n        permittee_address_post_code,\n        permittee_address_prov\n    FROM [stg].[mine_summary_view] \n    WHERE permit_id is not null\n) s\nGROUP BY permit_id;",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "writeBehavior": "upsert",
                                "upsertSettings": {
                                    "useTempDB": true,
                                    "keys": [
                                        "Permit_ID"
                                    ]
                                },
                                "sqlWriterUseTableLock": false,
                                "tableOption": "autoCreate",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "permit_id",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "Permit_ID",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_guid",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Guid",
                                            "type": "Guid",
                                            "physicalType": "uniqueidentifier"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_no",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_No",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_tenure",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Tenure",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_tenure_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Tenure_Type_Code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_commodity",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Commodity",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_commodity_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Commodity_Type_Code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_disturbance",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Disturbance",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_disturbance_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Disturbance_Type_Code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_status_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Status_Code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_status_changed_timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime2"
                                        },
                                        "sink": {
                                            "name": "Permit_Status_Changed_Timestamp",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_exemption_fee_status_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Exemption_Fee_Status_Code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_exemption_fee_status_d",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Exemption_Fee_Status_D",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permit_exemption_fee_status_note",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permit_Exemption_Fee_Status_Note",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_party_guid",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Party_Guid",
                                            "type": "Guid",
                                            "physicalType": "uniqueidentifier"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_first_name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_First_Name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Name",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_address_suite",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Address_Suite",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_address_line_1",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Address_Line_1",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_address_line_2",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Address_Line_2",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_address_city",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Address_City",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_address_post_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Address_Post_Code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "permittee_address_prov",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        },
                                        "sink": {
                                            "name": "Permittee_Address_Prov",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "v_Dim_mine_summary_view",
                                    "Schema": "stg"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureSqlTable1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "TableName": "DimPermitDetail",
                                    "Schema": "dbo"
                                }
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-12-17T11:18:40Z"
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/AzureSqlTable1')]"
            ]
        }
    ]
}